program FEM2DStaticStruct
  use tools
  use DataInputMOD
  use StructProblemMOD
  use SolverMOD
  use NormalStressMOD
  use ShearStressMOD
!!$  use StrainMOD
  use DataOutputMOD
  implicit none
  type(StructProblemTYPE) :: problem
  type(NormalStressTYPE) :: normalStress
  type(ShearStressTYPE) :: shearStress
!!$  type(StrainTYPE) :: strain
  print'(A)', 'Initiating FEM2DStructural'
  call initFEM2D(problem)
  call problem%setUp()
  call staticSolver(problem)
  call normalStress%calculateNormalStress(problem)
  call shearStress%calculateShearStress(problem)
!!$  call strain%calculateStrain(problem)
  call printResults(resultName = 'Displacement'                 &
       , step         = 1                                       &
       , graphType    = 'Vector'                                &
       , locationName = 'onNodes'                               &
       , resultNumber = problem%domain%nPoint                    &
       , component1   = problem%dof                              )
  call printResults(resultName = 'NormalStressOnTriangs'        &
       , type         = 'Triangle'                              &
       , step         = 1                                       &
       , graphType    = 'Vector'                                &
       , locationName = 'onGaussPoints'                         &
       , gaussPoints  = normalStress%triangGPoint               &
       , resultNumber = size(normalStress%triangElemID)         &
       , elemID       = normalStress%triangElemID               &
       , component1   = normalStress%triangNSx                   &
       , component2   = normalStress%triangNSy                   )
  call printResults(resultName = 'NormalStressOnQuads'          &
       , type         = 'Quadrilateral'                         &
       , step         = 1                                       &
       , graphType    = 'Vector'                                &
       , locationName = 'onGaussPoints'                         &
       , gaussPoints  = normalStress%quadGPoint                 &
       , resultNumber = size(normalStress%quadElemID)           &
       , elemID       = normalStress%quadElemID                 &
       , component1   = normalStress%quadNSx                     &
       , component2   = normalStress%quadNSy                     )
  call printResults(resultName = 'ShearStressOnTriangs'         &
       , type         = 'Triangle'                              &
       , step         = 1                                       &
       , graphType    = 'Scalar'                                &
       , locationName = 'onGaussPoints'                         &
       , gaussPoints  = shearStress%triangGPoint                &
       , resultNumber = size(shearStress%triangElemID)          &
       , elemID       = shearStress%triangElemID                &
       , component1   = shearStress%triangShS                   )
  call printResults(resultName = 'ShearStressOnQuads'           &
       , type         = 'Quadrilateral'                         &
       , step         = 1                                       &
       , graphType    = 'Scalar'                                &
       , locationName = 'onGaussPoints'                         &
       , gaussPoints  = shearStress%quadGPoint                  &
       , resultNumber = size(normalStress%quadElemID)           &
       , elemID       = shearStress%quadElemID                  &
       , component1   = shearStress%quadShS                     )
!!$  call printResults(resultName = 'StrainOnTriangs'              &
!!$       , type         = 'Triangle'                              &
!!$       , step         = 1                                       &
!!$       , graphType    = 'Vector'                                &
!!$       , locationName = 'onGaussPoints'                         &
!!$       , gaussPoints  = strain%triangGPoint                     &
!!$       , resultNumber = size(strain%triangElemID)               &
!!$       , elemID       = strain%triangElemID                     &
!!$       , component1   = strain%triangEpx                        &
!!$       , component2   = strain%triangEpy                        )
!!$  call printResults(resultName = 'StrainOnQuads'                &
!!$       , type         = 'Quadrilateral'                         &
!!$       , step         = 1                                       &
!!$       , graphType    = 'Vector'                                &
!!$       , locationName = 'onGaussPoints'                         &
!!$       , gaussPoints  = strain%quadGPoint                       &
!!$       , resultNumber = size(strain%quadElemID)                 &
!!$       , elemID       = strain%quadElemID                       &
!!$       , component1   = strain%quadEpx                          &
!!$       , component2   = strain%quadEpy                          )
  call finishProgram() 
end program FEM2DStaticStruct
