module SolverMOD
  use tools
  use DebuggerMOD
  use RHSMOD
  use StiffnessMOD
  use ProblemMOD
  use ThermalMOD
  use SparseKit
  implicit none
  private
  public :: staticSolver
  interface staticSolver
     procedure :: staticSolver
  end interface staticSolver
contains
  subroutine staticSolver(problem)
    implicit none
    class(ProblemTYPE), intent(inout) :: problem
    type(stiffnessTYPE) :: stiffness 
    real(rkind), dimension(:), allocatable :: rhs, dof
    real(rkind) :: start, finish
    call debugLog('Solving linear system')
    call cpu_time(start)
    problem%dof = CGOMP(problem%stiffness, problem%rhs%vector)
    !problem%dof = gmres(problem%stiffness, problem%rhs%vector)
    call cpu_time(finish)
    call debugLog('Done solving')
    print*, 'Solver time = ', (finish-start)/4
  end subroutine staticSolver
end module SolverMOD
